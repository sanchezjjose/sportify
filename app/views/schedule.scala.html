@(season: String, nextGame: Option[Game], games: List[Game])(user: User)(implicit flash: Flash)

@import helper._
@import controllers._

@main(Html(season + " Schedule."), nav = "schedule") {

    <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/schedule.css")">

    <div class="main">
      <div class="season">
        <h2 class="header">Regular Season</h2>

  	    <table class="table table-striped table-hover">
  		    <tbody>
  		    	<thead>
  			        <tr>
  			          <td>Details</td>
  			          <td>Status</td>
  			        </tr>
  		    	</thead>
		        @for(game <- games.filter(g => g.is_playoff_game == false)) {
              @if(nextGame.isDefined && nextGame.get.game_id == game.game_id) {
                <tr id="@game.game_id" class="success">
              } else{
                <tr id="@game.game_id">
              }
                  <td class="game-details">
                    <div>
                      <b>Game @game.game_seq</b> <br>
                      @game.startTime <br>
                      @game.address <br>
                      vs. @game.opponent <br>
                      <b>
                          @if(game.result.contains("W")){
                            <font color="green">@game.result</font>
                          }else{
                            <font color="red">@game.result</font>
                          }
                      </b>
                    </div>
                  </td>
                  <td>
                      <div class="schedule form">
                          <a href="/schedule/submit?status=in?game_id=@game.game_id" class="btn btn-primary">In</a>
                          <a href="/schedule/submit?status=out?game_id=@game.game_id" class="btn btn-default">Out</a>
                      </div>
                  </td>
                </tr>
		        }
  			   </tbody>
  	    </table>
      </div>

      <div class="season playoffs">
        <h2 class="header">Playoffs</h2>
        <table class="table table-striped table-hover">
            <tbody>
            <thead>
            <tr>
                <td>Details</td>
                <td>Status</td>
            </tr>
            </thead>

            @for(game <- games.filter(g => g.is_playoff_game == true)) {
              <tr id="@game.game_id">
                  <td class="game-details">
                      <b>Game @game.game_seq</b> <br>
                      @game.startTime <br>
                      @game.address <br>
                      vs. @game.opponent <br>
                      <b>
                          @if(game.result.contains("W")) {
                            <font color="green">@game.result</font>
                          }else {
                            <font color="red">@game.result</font>
                          }
                      </b>
                  </td>
                  <td class="game-rsvp">
                      <div class="schedule form">
                          <a href="/schedule/submit?status=in?game_id=@game.game_id" class="btn btn-danger">In</a>
                          <a href="/schedule/submit?status=out?game_id=@game.game_id" class="btn btn-default">Out</a>
                      </div>
                  </td>
              </tr>
            }
            </tbody>
        </table>
      </div>
    </div>

    <script type="text/javascript">
   	  $(document).ready(function () {
   	  	function init () {
   	  		$('.btn').click(function (ev) {
   	  			ev.preventDefault();
   	  			$.ajax({
   	  				url: $(this).attr('href'),
   	  				success: function (data) {
   	  					$('.alert').remove();
   	  					if (data.status === 'in') {
							$('.season:first-child').before('<div class="game-status-msg alert alert-info">'+data.msg+'</div>');
   	  					} else {
							$('.season:first-child').before('<div class="game-status-msg alert alert-danger" >'+data.msg+'</div>');
   	  					}
   	  					window.scrollTo(0, 0);
   	  					setTimeout(function clearMsg () {
   	  						$('.alert').fadeOut('1000', function (el) {
   	  							$(el).remove();
   	  						});
   	  					}, 5000);
   	  				}
   	  			});
   	  		});
   	  	}
   	  	init();
   	  });
   	 </script>
}

