@(gameForm: Form[GameForm], seasons: Option[Season], nextGame: Option[Game], games: List[Game], tVm: TeamViewModel)(implicit user: User, flash: Flash)

@import helper._
@import controllers._

@main(Html(seasons.map(_.title + " ").getOrElse("") + "Schedule."), nav = "schedule", tVm) {

@seasons.map { season =>

  <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/schedule.css")">
  <script src="@routes.Assets.at("javascripts/schedule.js")" type="text/javascript"></script>

  <div class="main">
    <div class="season regular" id="@season._id">

      <div class="message">
        @if(flash.get("failure").isDefined) {
            <div class="alert alert-danger">
                <button type="button" class="close" data-dismiss="alert">Ã—</button>
                @flash.get("failure")
            </div>
        }
      </div>

      <!--should be hidden-->
      @if(user.is_admin) {
        @(newGameForm())
        @(editGameForm())
      }

      <h2 class="header">Regular Season</h2>

      @if(user.is_admin) {
        <a href="#" class="add">+ Add game</a>
      }

      <table class="table table-striped table-hover">
  	    <tbody>
  	    	<thead>
  		        <tr>
  		          <td>Details</td>
  		          <td>Status</td>
  		        </tr>
  	    	</thead>
          @for(game <- games.filter(g => g.is_playoff_game == false)) {
            @if(nextGame.isDefined && nextGame.get._id == game._id) {
              <tr id="@game._id" class="success">
            } else{
              <tr id="@game._id">
            }
                <td class="game-details">
                  <div>
                    <b>Game @game.number</b> <br>
                    @game.start_time <br>
                    @game.address <br>
                    <i>@game.gym</i> <br>
                    vs. @game.opponent <br>
                    <b>
                        @if(game.result.contains("W")){
                          <font color="green">@game.result</font>
                        }else{
                          <font color="red">@game.result</font>
                        }
                    </b>

                    @if(user.is_admin) {
                      <div>
                        <br>
                        <a href="@routes.Schedule.edit(game._id)" class="edit text-muted">Edit</a> &nbsp;
                        <a href="#" onclick='deleteGame(@season._id, @game._id)' class="delete text-danger">Delete</a>
                      </div>
                    }

                  </div>
                </td>
                <td>
                    <div class="schedule form">
                        <a href="/schedule/submit?status=in?game_id=@game._id" class="btn btn-primary">In</a>
                        <a href="/schedule/submit?status=out?game_id=@game._id" class="btn btn-default">Out</a>
                    </div>
                </td>
              </tr>
          }
  		   </tbody>
      </table>
    </div>

    <div class="season playoffs">
      <h2 class="header">Playoffs</h2>

      @if(user.is_admin) {
        <a href="#" class="add">+ Add game</a>
      }

      <table class="table table-striped table-hover">
          <tbody>
          <thead>
          <tr>
              <td>Details</td>
              <td>Status</td>
          </tr>
          </thead>

          @for(game <- games.filter(g => g.is_playoff_game == true)) {
            <tr id="@game._id">
                <td class="game-details">
                    <b>Game @game.number</b> <br>
                    @game.start_time <br>
                    @game.address <br>
                    <i>@game.gym</i> <br>
                    vs. @game.opponent <br>
                    <b>
                        @if(game.result.contains("W")) {
                          <font color="green">@game.result</font>
                        }else {
                          <font color="red">@game.result</font>
                        }
                    </b>

                    @if(user.is_admin) {
                      <div>
                        <br>
                        <a href="@routes.Schedule.edit(game._id)" class="edit text-muted">Edit</a> &nbsp;
                        <a href="#" onclick='deleteGame(@season._id, @game._id)' class="delete text-danger">Delete</a>
                      </div>
                    }

                </td>
                <td class="game-rsvp">
                    <div class="schedule form">
                        <a href="/schedule/submit?status=in?game_id=@game._id" class="btn btn-danger">In</a>
                        <a href="/schedule/submit?status=out?game_id=@game._id" class="btn btn-default">Out</a>
                    </div>
                </td>
            </tr>
          }
          </tbody>
      </table>
    </div>
  </div>

  }.getOrElse {
      NO SCHEDULED GAMES.
  }
}

